
<div class="container mx-auto px-4 py-6">
  
  <!-- Search and Filter Bar -->
  <div class="glass-panel p-4 rounded-xl mb-8 sticky top-4 z-20 shadow-xl">
    <div class="flex flex-col md:flex-row gap-4 justify-between items-center">
      
      <!-- Search -->
      <div class="relative w-full md:w-1/3">
        <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
        <input 
          type="text" 
          [value]="searchQuery()"
          (input)="updateSearch($event)"
          placeholder="Search apps, games, drivers..." 
          class="w-full bg-black/50 border border-white/20 rounded-full py-2 pl-10 pr-4 text-white focus:outline-none focus:border-osama-green focus:shadow-[0_0_10px_rgba(0,255,65,0.3)] transition-all">
      </div>

      <!-- Filters -->
      <div class="flex flex-wrap gap-2 justify-center">
        <button (click)="filterType.set('All')" 
                class="px-4 py-1 rounded-full text-sm font-semibold transition-all border"
                [class]="filterType() === 'All' ? 'bg-osama-green text-black border-osama-green' : 'bg-transparent text-gray-300 border-white/20 hover:border-osama-green'">
          ALL
        </button>
        <button (click)="filterType.set('App')" 
                class="px-4 py-1 rounded-full text-sm font-semibold transition-all border"
                [class]="filterType() === 'App' ? 'bg-osama-green text-black border-osama-green' : 'bg-transparent text-gray-300 border-white/20 hover:border-osama-green'">
          APPS
        </button>
        <button (click)="filterType.set('Game')" 
                class="px-4 py-1 rounded-full text-sm font-semibold transition-all border"
                [class]="filterType() === 'Game' ? 'bg-osama-blue text-black border-osama-blue' : 'bg-transparent text-gray-300 border-white/20 hover:border-osama-blue'">
          GAMES
        </button>
        <button (click)="filterType.set('Driver')" 
                class="px-4 py-1 rounded-full text-sm font-semibold transition-all border"
                [class]="filterType() === 'Driver' ? 'bg-purple-500 text-white border-purple-500' : 'bg-transparent text-gray-300 border-white/20 hover:border-purple-500'">
          DRIVERS
        </button>
      </div>

      <!-- Sort & View -->
      <div class="flex gap-3 items-center">
        <select (change)="updateSort($event)" class="bg-black/50 border border-white/20 rounded text-sm text-gray-300 px-2 py-1 focus:outline-none focus:border-osama-green">
          <option value="date-desc">Newest First</option>
          <option value="date-asc">Oldest First</option>
          <option value="name-asc">A-Z</option>
          <option value="name-desc">Z-A</option>
          <option value="downloads">Most Downloaded</option>
          <option value="rating">Highest Rated</option>
        </select>
        
        <button (click)="toggleView()" class="text-gray-400 hover:text-white transition-colors">
          @if (viewMode() === 'grid') {
            <i class="fas fa-th-list text-xl" title="List View"></i>
          } @else {
            <i class="fas fa-th text-xl" title="Grid View"></i>
          }
        </button>
      </div>
    </div>
  </div>

  <!-- Content Grid -->
  @if (filteredItems().length === 0) {
    <div class="text-center py-20 opacity-50">
      <i class="fas fa-ghost text-6xl mb-4 text-gray-600"></i>
      <h2 class="text-2xl font-bold">No results found</h2>
      <p>Try adjusting your search or filters</p>
    </div>
  } @else {
    <div [class]="viewMode() === 'grid' ? 'grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6' : 'flex flex-col gap-4'">
      @for (item of filteredItems(); track item.id) {
        @if (viewMode() === 'grid') {
          <app-item-card 
            [item]="item"
            (download)="handleDownload($event)"
            (rate)="handleRate($event)"
          ></app-item-card>
        } @else {
          <!-- List View Implementation -->
          <div class="glass-panel p-4 rounded-xl flex items-center gap-4 hover:bg-white/5 transition-all">
             <img [src]="item.icon" class="w-12 h-12 rounded bg-black/50 object-cover">
             <div class="flex-1">
               <h3 class="font-bold text-white">{{ item.name }}</h3>
               <div class="text-xs text-gray-400">{{ item.type }} â€¢ {{ item.releaseDate }}</div>
             </div>
             <div class="text-right mr-4 hidden sm:block">
               <div class="text-osama-green font-mono">{{ item.downloads | number }} DLs</div>
               <div class="text-yellow-500 text-sm"><i class="fas fa-star"></i> {{ item.rating | number:'1.1-1' }}</div>
             </div>
             <button (click)="handleDownload(item.id)" class="bg-osama-green-dim hover:bg-osama-green text-white px-4 py-2 rounded text-sm font-bold">
               <i class="fas fa-download"></i>
             </button>
          </div>
        }
      }
    </div>
  }
</div>
